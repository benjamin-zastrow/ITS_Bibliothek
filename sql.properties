reservationFindTitleByExemplarID=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID  = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE e.EXEMPLAR_ID = ? AND ((SYSDATE - e.RETURN_DATE) < 365 OR e.RETURN_DATE IS NULL) AND ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0))
reservationFindTitleByName=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID  = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE LOWER(m.NAME) LIKE LOWER(('%' || ? || '%')) AND ((SYSDATE - e.RETURN_DATE) < 365 OR e.RETURN_DATE IS NULL) AND ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0))
fskCheck=SELECT 0 FROM CUSTOMER c, EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) WHERE (SYSDATE - c.BIRTHDATE) / 365.25 > m.FSK_RATING AND c.CUSTOMER_ID = ? AND e.EXEMPLAR_ID = ?
reservableCheck=SELECT 0 FROM EXEMPLAR e LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.RESERVATION_ID = a.RESERVATION_RESERVATION_ID) LEFT OUTER JOIN CUSTOMER c ON (a.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0)) AND e.EXEMPLAR_ID = ?
createReservation=INSERT INTO RESERVATION (RESERVATION_ID, RESERVATION_TIME, FETCH_DUE_TIME, EXEMPLAR_EXEMPLAR_ID, EXEMPLAR_MEDIA_MEDIA_ID, CUSTOMER_CUSTOMER_ID) VALUES((SELECT COUNT(r.RESERVATION_ID) + 1 FROM RESERVATION r), SYSDATE, TO_DATE(?, 'DD-MM-YYYY HH24:MI'), ?, ?, ?)
getLatestReservationID=SELECT COUNT(r.RESERVATION_ID) AS ERSTELLTEID FROM RESERVATION r

borrowFindTitleByReservationID=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, r.RESERVATION_ID AS RID FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE r.RESERVATION_ID = ? AND (r.FETCH_DUE_TIME - SYSDATE) <= 0.5 AND (r.FETCH_DUE_TIME - SYSDATE) >= -0.5 AND (e.IS_BORROWED = 'f')
borrowFindTitleByExemplarID=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, r.RESERVATION_ID AS RID FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE e.EXEMPLAR_ID = ? AND ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0))
borrowFindTitleByMediaID=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, r.RESERVATION_ID AS RID FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE m.MEDIA_ID = ? AND ((SYSDATE - a.REAL_RETURN_TIME) < 365 OR a.REAL_RETURN_TIME IS NULL) AND ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0))
borrowFindTitleByName=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, r.RESERVATION_ID AS RID FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE LOWER(m.NAME) LIKE LOWER('%' || ? || '%') AND ((SYSDATE - e.RETURN_DATE) < 365 OR e.RETURN_DATE IS NULL) AND ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0))
borrowFindTitleByMediaType=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, r.RESERVATION_ID AS RID FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE m.MEDIATYPE_MEDIATYPEID = (SELECT m2.MEDIATYPEID FROM MEDIATYPE m2 WHERE LOWER(m2.MEDIATYPENAME) LIKE LOWER('%' || ? || '%')) AND ((SYSDATE - e.RETURN_DATE) < 365 OR e.RETURN_DATE IS NULL) AND ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0))
borrowableCheck=SELECT 0 FROM EXEMPLAR e LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (r.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE ((e.IS_BORROWED = 'f' AND c.NAME IS NULL) OR (e.IS_BORROWED = 'f' AND (r.FETCH_DUE_TIME - SYSDATE) >= 1) OR (e.IS_BORROWED = 'f' AND (a.REAL_RETURN_TIME - SYSDATE) < 0) OR (e.IS_BORROWED = 'f' AND ((r.FETCH_DUE_TIME - SYSDATE) <= 0.5 AND (r.FETCH_DUE_TIME - SYSDATE) >= -0.5))) AND e.EXEMPLAR_ID  = ? FOR UPDATE OF IS_BORROWED
setExemplarBorrowStatus=UPDATE EXEMPLAR e SET e.IS_BORROWED = ? WHERE e.EXEMPLAR_ID = ?
createAusleihe=INSERT INTO AUSLEIHE (AUSLEIHE_ID, BORROWING_TIME, ESTIMATED_RETURN_TIME, BASED_ON_RESERVATION, EXEMPLAR_MEDIA_MEDIA_ID, EXEMPLAR_EXEMPLAR_ID, CUSTOMER_CUSTOMER_ID, RESERVATION_RESERVATION_ID, PRICE) VALUES((SELECT COUNT(a.AUSLEIHE_ID) + 1 FROM AUSLEIHE a), SYSDATE, TO_DATE(?, 'DD-MM-YYYY HH24:MI'), ?, ?, ?, ?, ?, (SELECT SUM(p2.PRICE) AS PRICE FROM PREIS p2 INNER JOIN MEDIA m3 ON (m3.MEDIATYPE_MEDIATYPEID = p2.MEDIATYPE_MEDIATYPEID) INNER JOIN GENREMEDIARELATION g2 ON (g2.GENRE_GENRE_ID = p2.GENRE_GENRE_ID) WHERE g2.MEDIA_MEDIA_ID = m3.MEDIA_ID AND m3.MEDIA_ID = ?))
getLatestAusleiheID=SELECT COUNT(a.AUSLEIHE_ID) AS ERSTELLTEID FROM AUSLEIHE a

returnFindTitleByExemplarID=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, a.BORROWING_TIME AS AUSLEIHEZEIT, a.ESTIMATED_RETURN_TIME AS ERWARTETERÜCKGABEZEIT FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (a.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE e.EXEMPLAR_ID = ? AND e.IS_BORROWED = 't' 
returnFindTitleByMediaID=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, a.BORROWING_TIME AS AUSLEIHEZEIT, a.ESTIMATED_RETURN_TIME AS ERWARTETERÜCKGABEZEIT FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (a.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE m.MEDIA_ID = ? AND e.IS_BORROWED = 't'
returnFindTitleByName=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID,m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, a.BORROWING_TIME AS AUSLEIHEZEIT, a.ESTIMATED_RETURN_TIME AS ERWARTETERÜCKGABEZEIT FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (a.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE LOWER(m.NAME) LIKE LOWER('%' || ? || '%') AND e.IS_BORROWED = 't'
returnFindTitleByMediaType=SELECT m.NAME AS NAME, e.EXEMPLAR_ID AS ID, m.MEDIA_ID AS MID, m.CREATOR AS URHEBER, e.IS_BORROWED AS AUSLEIHESTATUS, c.NAME AS RESERVATOR, a.BORROWING_TIME AS AUSLEIHEZEIT, a.ESTIMATED_RETURN_TIME AS ERWARTETERÜCKGABEZEIT FROM EXEMPLAR e INNER JOIN MEDIA m ON (e.MEDIA_MEDIA_ID = m.MEDIA_ID) LEFT OUTER JOIN AUSLEIHE a ON (a.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN RESERVATION r ON (r.EXEMPLAR_EXEMPLAR_ID = e.EXEMPLAR_ID) LEFT OUTER JOIN CUSTOMER c ON (a.CUSTOMER_CUSTOMER_ID = c.CUSTOMER_ID) WHERE m.MEDIATYPE_MEDIATYPEID = (SELECT m2.MEDIATYPEID FROM MEDIATYPE m2 WHERE LOWER(m2.MEDIATYPENAME) LIKE LOWER('%' || ? || '%')) AND e.IS_BORROWED = 't'
returnTitle1=UPDATE EXEMPLAR SET IS_BORROWED='f', RETURN_DATE=SYSDATE , LENDING_COUNT=LENDING_COUNT+1, LENDING_TIME_SUM=(SYSDATE - (SELECT a.BORROWING_TIME FROM AUSLEIHE a WHERE a.EXEMPLAR_EXEMPLAR_ID=?)) WHERE EXEMPLAR_ID=?
returnTitle2=UPDATE AUSLEIHE SET REAL_RETURN_TIME=SYSDATE WHERE EXEMPLAR_EXEMPLAR_ID = ?
returnTitle3=UPDATE CUSTOMER SET PENALTYCHARGE=(SYSDATE - (SELECT a.ESTIMATED_RETURN_TIME FROM AUSLEIHE a WHERE a.EXEMPLAR_EXEMPLAR_ID=?))*((SELECT SUM(p2.PRICE) AS PRICE FROM PREIS p2 INNER JOIN MEDIA m3 ON (m3.MEDIATYPE_MEDIATYPEID = p2.MEDIATYPE_MEDIATYPEID) INNER JOIN GENREMEDIARELATION g2 ON (g2.GENRE_GENRE_ID = p2.GENRE_GENRE_ID) WHERE g2.MEDIA_MEDIA_ID = m3.MEDIA_ID AND m3.MEDIA_ID = ?) / 10) WHERE (CUSTOMER_ID=? AND (SYSDATE - (SELECT a.ESTIMATED_RETURN_TIME FROM AUSLEIHE a WHERE a.EXEMPLAR_EXEMPLAR_ID=?)) >= 0)